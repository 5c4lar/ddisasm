value_used_for_address(Val, Size, Direction, Expr):-
    address_expr_simplified(Val, Expr),
    op_to_val(EA, _, _, Direction, Val),
    instruction_memory_access_size(EA, _, Size).